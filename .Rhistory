prep.multi()
#Shorthand
sl = post.multi$BUGSoutput$sims.list
su = post.multi$BUGSoutput$summary
#Get some indicies
sims = nrow(sl$BWT.b)
BWT.b.start = match("BWT.b[1]", row.names(su))
d18O.b.start = match("d18O_sw.b[1]", row.names(su))
BWT.e.start = match("BWT.e[1]", row.names(su))
d18O.e.start = match("d18O_sw.e[1]", row.names(su))
##Calculate paired difference between d18O_sw samples for two records
#Get quantile value for zero difference
d18O_sw.delta = sl$d18O_sw.b - sl$d18O_sw.e
d18O_sw.ptiles = matrix(double(), ncol = ncol(d18O_sw.delta), nrow = 4)
for(j in 1:ncol(d18O_sw.delta)){
d18O_sw.ptiles[1:3,j] = quantile(d18O_sw.delta[,j], c(0.025,0.5,0.975))
tst = ecdf(d18O_sw.delta[,j])
d18O_sw.ptiles[4,j] = tst(0)
}
##Plot difference in d18Osw and zero difference probs
plot(-10, 0, xlab = "Age (ka)", ylab = expression(Delta*delta^{18}*"O"[sw]*" (U1385 - 1123)"),
xlim=c(1239,1315), ylim=c(-0.5,2))
for(i in seq(1, sims, by = max(floor(sims / 1500),1))){
lines(ts.ages, d18O_sw.delta[i,], col = rgb(0,0,0, 0.01))
}
lines(ts.ages, d18O_sw.ptiles[2,], col="red")
lines(ts.ages, d18O_sw.ptiles[1,], col="red", lty=3)
lines(ts.ages, d18O_sw.ptiles[3,], col="red", lty=3)
par(new = TRUE)
plot(ts.ages, pmax(pmin(d18O_sw.ptiles[4,],1-d18O_sw.ptiles[4,]), 5e-4), type="l", log="y",
axes = FALSE, xlim=c(1239,1315), ylim=c(5e-4,5e-1), xlab="", ylab="", col="blue")
axis(4, at=c(5e-4,5e-3,5e-2,5e-1))
lines(c(1230,1320), c(0.05,0.05), lty=2, col="blue")
lines(c(1230,1320), c(0.01,0.01), lty=2, col="blue")
xl = par("usr")[1]+(par("usr")[2]-par("usr")[1])/25
yl = par("usr")[4]-(par("usr")[4]-par("usr")[3])/15
text(xl, yl, "B")
##Calculate paired difference between d18O_sw samples for two records
#Get quantile value for zero difference
d18O_sw.delta = post.birn$BUGSoutput$sims.list$d18O_sw - post.elder$BUGSoutput$sims.list$d18O_sw
d18O_sw.ptiles = matrix(double(), ncol = ncol(d18O_sw.delta), nrow = 4)
for(j in 1:ncol(d18O_sw.delta)){
d18O_sw.ptiles[1:3,j] = quantile(d18O_sw.delta[,j], c(0.025,0.5,0.975))
tst = ecdf(d18O_sw.delta[,j])
d18O_sw.ptiles[4,j] = tst(0)
}
lines(ts.ages, pmax(pmin(d18O_sw.ptiles[4,],1-d18O_sw.ptiles[4,]), 5e-4), lty=3, col="blue")
mtext(side = 4, "Zero difference probability", line = 2.75)
dev.off()
source("helpers.R")
#using Lear analysis
prep.lear()
#Shorthand
sl = post.lear$BUGSoutput$sims.list
su = post.lear$BUGSoutput$summary
#Get some indicies
sims = nrow(sl$BWT)
BWT.start = match("BWT[1]", row.names(su))
d18O.start = match("d18O_sw[1]", row.names(su))
MgCa.start = match("MgCa_sw_m[1]", row.names(su))
#This one calculates change relative to modern
BWT.delta = matrix(rep(0, sims * (ts.len)), nrow = sims, ncol = (ts.len))
for(i in 1:sims){
for(j in 1:(ts.len)){ BWT.delta[i,j] = sl$BWT[i,j] - sl$BWT[i,ts.len]}
}
#This gets the zero change value from the emperical CDF of the change time series
BWT.delta.p = double()
for(j in 1:ts.len){
tst = ecdf(BWT.delta[,j])
BWT.delta.p[j] = tst(0)
}
#This gets the CDF value of the modern median from each time steps ECDF
trad = su[(BWT.start + ts.len - 1), 5]
BWT.p = double()
for(j in 1:ts.len){
tst = ecdf(sl$BWT[,j])
BWT.p[j] = tst(trad)
}
#Now a plot showing probabilities on delta T relative to modern
png("deltas.png", res=300, units="in", width = 5, height = 5.5)
layout(matrix(c(1,2), nrow = 2))
par(mar = c(4,4.5,1,4), cex = 0.85)
plot(-10, 0, xlab = "", ylab = "", xlim=c(0.05,2), ylim=c(-2.5,2))
title(xlab = "Age (Ma)", line = 2.75)
title(ylab = expression("BWT ("*degree*" C)"), line = 2.75)
for(i in seq(1, sims, by = max(floor(sims / 2500),1))){
lines(ts.ages, sl$BWT[i,], col = rgb(0,0,0, 0.01))
}
lines(ts.ages, su[BWT.start:(BWT.start + ts.len - 1), 5], col="red")
lines(ts.ages, su[BWT.start:(BWT.start + ts.len - 1), 3], col="red", lty=3)
lines(ts.ages, su[BWT.start:(BWT.start + ts.len - 1), 7], col="red", lty=3)
xl = par("usr")[1]+(par("usr")[2]-par("usr")[1])/25
yl = par("usr")[4]-(par("usr")[4]-par("usr")[3])/15
text(xl, yl, "A")
par(new=TRUE)
plot(ts.ages[1:(ts.len-1)], BWT.delta.p[1:(ts.len-1)], xlim=c(0.05,2), ylim=c(5e-3, 1), type="l",
axes=FALSE, log="y", xlab="", ylab="", col="blue")
lines(ts.ages[1:(ts.len-1)], BWT.p[1:(ts.len-1)], lty=3, col="blue")
lines(c(-1,6), c(0.05,0.05), lty=2, col="blue")
lines(c(-1,6), c(0.01,0.01), lty=2, col="blue")
axis(4, at=c(5e-5,5e-4,5e-3,5e-2,5e-1))
mtext(side = 4, "Zero change probability", line = 2.75)
##Now switch over to the multi analysis
prep.multi()
#Shorthand
sl = post.multi$BUGSoutput$sims.list
su = post.multi$BUGSoutput$summary
#Get some indicies
sims = nrow(sl$BWT.b)
BWT.b.start = match("BWT.b[1]", row.names(su))
d18O.b.start = match("d18O_sw.b[1]", row.names(su))
BWT.e.start = match("BWT.e[1]", row.names(su))
d18O.e.start = match("d18O_sw.e[1]", row.names(su))
##Calculate paired difference between d18O_sw samples for two records
#Get quantile value for zero difference
d18O_sw.delta = sl$d18O_sw.b - sl$d18O_sw.e
d18O_sw.ptiles = matrix(double(), ncol = ncol(d18O_sw.delta), nrow = 4)
for(j in 1:ncol(d18O_sw.delta)){
d18O_sw.ptiles[1:3,j] = quantile(d18O_sw.delta[,j], c(0.025,0.5,0.975))
tst = ecdf(d18O_sw.delta[,j])
d18O_sw.ptiles[4,j] = tst(0)
}
##Plot difference in d18Osw and zero difference probs
plot(-10, 0, xlab = "Age (ka)", ylab = expression(Delta*delta^{18}*"O"[sw]*" (U1385 - 1123)"),
xlim=c(1239,1315), ylim=c(-0.5,2))
for(i in seq(1, sims, by = max(floor(sims / 1500),1))){
lines(ts.ages, d18O_sw.delta[i,], col = rgb(0,0,0, 0.01))
}
lines(ts.ages, d18O_sw.ptiles[2,], col="red")
lines(ts.ages, d18O_sw.ptiles[1,], col="red", lty=3)
lines(ts.ages, d18O_sw.ptiles[3,], col="red", lty=3)
par(new = TRUE)
plot(ts.ages, pmax(pmin(d18O_sw.ptiles[4,],1-d18O_sw.ptiles[4,]), 5e-4), type="l", log="y",
axes = FALSE, xlim=c(1239,1315), ylim=c(5e-4,5e-1), xlab="", ylab="", col="blue")
axis(4, at=c(5e-4,5e-3,5e-2,5e-1))
lines(c(1230,1320), c(0.05,0.05), lty=2, col="blue")
lines(c(1230,1320), c(0.01,0.01), lty=2, col="blue")
xl = par("usr")[1]+(par("usr")[2]-par("usr")[1])/25
yl = par("usr")[4]-(par("usr")[4]-par("usr")[3])/15
text(xl, yl, "B")
##Calculate paired difference between d18O_sw samples for two records
#Get quantile value for zero difference
d18O_sw.delta = post.birn$BUGSoutput$sims.list$d18O_sw - post.elder$BUGSoutput$sims.list$d18O_sw
d18O_sw.ptiles = matrix(double(), ncol = ncol(d18O_sw.delta), nrow = 4)
for(j in 1:ncol(d18O_sw.delta)){
d18O_sw.ptiles[1:3,j] = quantile(d18O_sw.delta[,j], c(0.025,0.5,0.975))
tst = ecdf(d18O_sw.delta[,j])
d18O_sw.ptiles[4,j] = tst(0)
}
lines(ts.ages, pmax(pmin(d18O_sw.ptiles[4,],1-d18O_sw.ptiles[4,]), 5e-4), lty=3, col="blue")
mtext(side = 4, "Zero difference probability", line = 2.75)
dev.off()
load("post_birn.RData")
load("post_elder.RData")
#using Lear analysis
prep.lear()
#Shorthand
sl = post.lear$BUGSoutput$sims.list
su = post.lear$BUGSoutput$summary
#Get some indicies
sims = nrow(sl$BWT)
BWT.start = match("BWT[1]", row.names(su))
d18O.start = match("d18O_sw[1]", row.names(su))
MgCa.start = match("MgCa_sw_m[1]", row.names(su))
#This one calculates change relative to modern
BWT.delta = matrix(rep(0, sims * (ts.len)), nrow = sims, ncol = (ts.len))
for(i in 1:sims){
for(j in 1:(ts.len)){ BWT.delta[i,j] = sl$BWT[i,j] - sl$BWT[i,ts.len]}
}
#This gets the zero change value from the emperical CDF of the change time series
BWT.delta.p = double()
for(j in 1:ts.len){
tst = ecdf(BWT.delta[,j])
BWT.delta.p[j] = tst(0)
}
#This gets the CDF value of the modern median from each time steps ECDF
trad = su[(BWT.start + ts.len - 1), 5]
BWT.p = double()
for(j in 1:ts.len){
tst = ecdf(sl$BWT[,j])
BWT.p[j] = tst(trad)
}
#Now a plot showing probabilities on delta T relative to modern
png("Figure9.png", res=300, units="in", width = 5, height = 5.5)
layout(matrix(c(1,2), nrow = 2))
par(mar = c(4,4.5,1,4), cex = 0.85)
plot(-10, 0, xlab = "", ylab = "", xlim=c(0.05,2), ylim=c(-2.5,2))
title(xlab = "Age (Ma)", line = 2.75)
title(ylab = expression("BWT ("*degree*" C)"), line = 2.75)
for(i in seq(1, sims, by = max(floor(sims / 2500),1))){
lines(ts.ages, sl$BWT[i,], col = rgb(0,0,0, 0.01))
}
lines(ts.ages, su[BWT.start:(BWT.start + ts.len - 1), 5], col="red")
lines(ts.ages, su[BWT.start:(BWT.start + ts.len - 1), 3], col="red", lty=3)
lines(ts.ages, su[BWT.start:(BWT.start + ts.len - 1), 7], col="red", lty=3)
xl = par("usr")[1]+(par("usr")[2]-par("usr")[1])/25
yl = par("usr")[4]-(par("usr")[4]-par("usr")[3])/15
text(xl, yl, "A")
par(new=TRUE)
plot(ts.ages[1:(ts.len-1)], BWT.delta.p[1:(ts.len-1)], xlim=c(0.05,2), ylim=c(5e-3, 1), type="l",
axes=FALSE, log="y", xlab="", ylab="", col="blue")
lines(ts.ages[1:(ts.len-1)], BWT.p[1:(ts.len-1)], lty=3, col="blue")
lines(c(-1,6), c(0.05,0.05), lty=2, col="blue")
lines(c(-1,6), c(0.01,0.01), lty=2, col="blue")
axis(4, at=c(5e-5,5e-4,5e-3,5e-2,5e-1))
mtext(side = 4, "Zero change probability", line = 2.75)
##Now switch over to the multi analysis
prep.multi()
#Shorthand
sl = post.multi$BUGSoutput$sims.list
su = post.multi$BUGSoutput$summary
#Get some indicies
sims = nrow(sl$BWT.b)
BWT.b.start = match("BWT.b[1]", row.names(su))
d18O.b.start = match("d18O_sw.b[1]", row.names(su))
BWT.e.start = match("BWT.e[1]", row.names(su))
d18O.e.start = match("d18O_sw.e[1]", row.names(su))
##Calculate paired difference between d18O_sw samples for two records
#Get quantile value for zero difference
d18O_sw.delta = sl$d18O_sw.b - sl$d18O_sw.e
d18O_sw.ptiles = matrix(double(), ncol = ncol(d18O_sw.delta), nrow = 4)
for(j in 1:ncol(d18O_sw.delta)){
d18O_sw.ptiles[1:3,j] = quantile(d18O_sw.delta[,j], c(0.025,0.5,0.975))
tst = ecdf(d18O_sw.delta[,j])
d18O_sw.ptiles[4,j] = tst(0)
}
##Plot difference in d18Osw and zero difference probs
plot(-10, 0, xlab = "Age (ka)", ylab = expression(Delta*delta^{18}*"O"[sw]*" (U1385 - 1123)"),
xlim=c(1239,1315), ylim=c(-0.5,2))
for(i in seq(1, sims, by = max(floor(sims / 1500),1))){
lines(ts.ages, d18O_sw.delta[i,], col = rgb(0,0,0, 0.01))
}
lines(ts.ages, d18O_sw.ptiles[2,], col="red")
lines(ts.ages, d18O_sw.ptiles[1,], col="red", lty=3)
lines(ts.ages, d18O_sw.ptiles[3,], col="red", lty=3)
par(new = TRUE)
plot(ts.ages, pmax(pmin(d18O_sw.ptiles[4,],1-d18O_sw.ptiles[4,]), 5e-4), type="l", log="y",
axes = FALSE, xlim=c(1239,1315), ylim=c(5e-4,5e-1), xlab="", ylab="", col="blue")
axis(4, at=c(5e-4,5e-3,5e-2,5e-1))
lines(c(1230,1320), c(0.05,0.05), lty=2, col="blue")
lines(c(1230,1320), c(0.01,0.01), lty=2, col="blue")
xl = par("usr")[1]+(par("usr")[2]-par("usr")[1])/25
yl = par("usr")[4]-(par("usr")[4]-par("usr")[3])/15
text(xl, yl, "B")
##Calculate paired difference between d18O_sw samples for two records
#Get quantile value for zero difference
d18O_sw.delta = post.birn$BUGSoutput$sims.list$d18O_sw - post.elder$BUGSoutput$sims.list$d18O_sw
d18O_sw.ptiles = matrix(double(), ncol = ncol(d18O_sw.delta), nrow = 4)
for(j in 1:ncol(d18O_sw.delta)){
d18O_sw.ptiles[1:3,j] = quantile(d18O_sw.delta[,j], c(0.025,0.5,0.975))
tst = ecdf(d18O_sw.delta[,j])
d18O_sw.ptiles[4,j] = tst(0)
}
lines(ts.ages, pmax(pmin(d18O_sw.ptiles[4,],1-d18O_sw.ptiles[4,]), 5e-4), lty=3, col="blue")
mtext(side = 4, "Zero difference probability", line = 2.75)
dev.off()
#using Lear analysis
prep.lear()
#Shorthand
sl = post.lear$BUGSoutput$sims.list
su = post.lear$BUGSoutput$summary
#Get some indicies
sims = nrow(sl$BWT)
BWT.start = match("BWT[1]", row.names(su))
d18O.start = match("d18O_sw[1]", row.names(su))
MgCa.start = match("MgCa_sw_m[1]", row.names(su))
#This one calculates change relative to modern
BWT.delta = matrix(rep(0, sims * (ts.len)), nrow = sims, ncol = (ts.len))
for(i in 1:sims){
for(j in 1:(ts.len)){ BWT.delta[i,j] = sl$BWT[i,j] - sl$BWT[i,ts.len]}
}
#This gets the zero change value from the emperical CDF of the change time series
BWT.delta.p = double()
for(j in 1:ts.len){
tst = ecdf(BWT.delta[,j])
BWT.delta.p[j] = tst(0)
}
#This gets the CDF value of the modern median from each time steps ECDF
trad = su[(BWT.start + ts.len - 1), 5]
BWT.p = double()
for(j in 1:ts.len){
tst = ecdf(sl$BWT[,j])
BWT.p[j] = tst(trad)
}
#Now a plot showing probabilities on delta T relative to modern
png("Figure9.png", res=300, units="in", width = 5, height = 5.5)
layout(matrix(c(1,2), nrow = 2))
par(mar = c(4,4.5,1,4), cex = 0.85)
plot(-10, 0, xlab = "", ylab = "", xlim=c(0.05,2), ylim=c(-2.5,2))
title(xlab = "Age (Ma)", line = 2.75)
title(ylab = expression("BWT ("*degree*" C)"), line = 2.75)
for(i in seq(1, sims, by = max(floor(sims / 2500),1))){
lines(ts.ages, sl$BWT[i,], col = rgb(0,0,0, 0.01))
}
lines(ts.ages, su[BWT.start:(BWT.start + ts.len - 1), 5], col="red")
lines(ts.ages, su[BWT.start:(BWT.start + ts.len - 1), 3], col="red", lty=3)
lines(ts.ages, su[BWT.start:(BWT.start + ts.len - 1), 7], col="red", lty=3)
xl = par("usr")[1]+(par("usr")[2]-par("usr")[1])/25
yl = par("usr")[4]-(par("usr")[4]-par("usr")[3])/15
text(xl, yl, "A")
par(new=TRUE)
plot(ts.ages[1:(ts.len-1)], BWT.delta.p[1:(ts.len-1)], xlim=c(0.05,2), ylim=c(5e-3, 1), type="l",
axes=FALSE, log="y", xlab="", ylab="", col="blue")
lines(ts.ages[1:(ts.len-1)], BWT.p[1:(ts.len-1)], lty=3, col="blue")
lines(c(-1,6), c(0.05,0.05), lty=2, col="blue")
lines(c(-1,6), c(0.01,0.01), lty=2, col="blue")
axis(4, at=c(5e-5,5e-4,5e-3,5e-2,5e-1))
mtext(side = 4, "Zero change probability", line = 2.75)
##Now switch over to the multi analysis
prep.multi()
#Shorthand
sl = post.multi$BUGSoutput$sims.list
su = post.multi$BUGSoutput$summary
#Get some indicies
sims = nrow(sl$BWT.b)
BWT.b.start = match("BWT.b[1]", row.names(su))
d18O.b.start = match("d18O_sw.b[1]", row.names(su))
BWT.e.start = match("BWT.e[1]", row.names(su))
d18O.e.start = match("d18O_sw.e[1]", row.names(su))
##Calculate paired difference between d18O_sw samples for two records
#Get quantile value for zero difference
d18O_sw.delta = sl$d18O_sw.b - sl$d18O_sw.e
d18O_sw.ptiles = matrix(double(), ncol = ncol(d18O_sw.delta), nrow = 4)
for(j in 1:ncol(d18O_sw.delta)){
d18O_sw.ptiles[1:3,j] = quantile(d18O_sw.delta[,j], c(0.025,0.5,0.975))
tst = ecdf(d18O_sw.delta[,j])
d18O_sw.ptiles[4,j] = tst(0)
}
##Plot difference in d18Osw and zero difference probs
plot(-10, 0, xlab = "Age (ka)", ylab = expression(Delta*delta^{18}*"O"[sw]*" (U1385 - 1123)"),
xlim=c(1239,1315), ylim=c(-0.5,2))
for(i in seq(1, sims, by = max(floor(sims / 1500),1))){
lines(ts.ages, d18O_sw.delta[i,], col = rgb(0,0,0, 0.01))
}
lines(ts.ages, d18O_sw.ptiles[2,], col="red")
lines(ts.ages, d18O_sw.ptiles[1,], col="red", lty=3)
lines(ts.ages, d18O_sw.ptiles[3,], col="red", lty=3)
xl = par("usr")[1]+(par("usr")[2]-par("usr")[1])/25
yl = par("usr")[4]-(par("usr")[4]-par("usr")[3])/15
text(xl, yl, "B")
par(new = TRUE)
plot(ts.ages, pmax(pmin(d18O_sw.ptiles[4,],1-d18O_sw.ptiles[4,]), 5e-4), type="l", log="y",
axes = FALSE, xlim=c(1239,1315), ylim=c(5e-4,5e-1), xlab="", ylab="", col="blue")
axis(4, at=c(5e-4,5e-3,5e-2,5e-1))
lines(c(1230,1320), c(0.05,0.05), lty=2, col="blue")
lines(c(1230,1320), c(0.01,0.01), lty=2, col="blue")
##Calculate paired difference between d18O_sw samples for two records
#Get quantile value for zero difference
d18O_sw.delta = post.birn$BUGSoutput$sims.list$d18O_sw - post.elder$BUGSoutput$sims.list$d18O_sw
d18O_sw.ptiles = matrix(double(), ncol = ncol(d18O_sw.delta), nrow = 4)
for(j in 1:ncol(d18O_sw.delta)){
d18O_sw.ptiles[1:3,j] = quantile(d18O_sw.delta[,j], c(0.025,0.5,0.975))
tst = ecdf(d18O_sw.delta[,j])
d18O_sw.ptiles[4,j] = tst(0)
}
lines(ts.ages, pmax(pmin(d18O_sw.ptiles[4,],1-d18O_sw.ptiles[4,]), 5e-4), lty=3, col="blue")
mtext(side = 4, "Zero difference probability", line = 2.75)
dev.off()
plot(-10, 0, xlab = "", ylab = "", xlim=c(0.05,2), ylim=c(-2.5,2))
title(xlab = "Age (Ma)", line = 2.75)
title(ylab = expression("BWT ("*degree*" C)"), line = 2.75)
for(i in seq(1, sims, by = max(floor(sims / 2500),1))){
lines(ts.ages, sl$BWT[i,]-sl$BWT[i,361], col = rgb(0,0,0, 0.01))
}
#using Lear analysis
prep.lear()
#Shorthand
sl = post.lear$BUGSoutput$sims.list
su = post.lear$BUGSoutput$summary
#Get some indicies
sims = nrow(sl$BWT)
BWT.start = match("BWT[1]", row.names(su))
d18O.start = match("d18O_sw[1]", row.names(su))
MgCa.start = match("MgCa_sw_m[1]", row.names(su))
lines(ts.ages, sl$BWT[i,]-sl$BWT[i,361], col = rgb(0,0,0, 0.01))
lines(ts.ages, BWT.delta[i,], col = rgb(0,0,0, 0.01))
for(i in seq(1, sims, by = max(floor(sims / 2500),1))){
lines(ts.ages, BWT.delta[i,], col = rgb(0,0,0, 0.01))
}
med = median(sl$BWT[,361])
plot(-10, 0, xlab = "", ylab = "", xlim=c(0.05,2), ylim=c(-1.5,3.5))
title(xlab = "Age (Ma)", line = 2.75)
title(ylab = expression("BWT ("*degree*" C)"), line = 2.75)
for(i in seq(1, sims, by = max(floor(sims / 2500),1))){
lines(ts.ages, sl$BWT[i,]-med, col = rgb(0,0,0, 0.01))
}
lines(ts.ages, su[BWT.start:(BWT.start + ts.len - 1)-med, 5], col="red")
lines(ts.ages, su[BWT.start:(BWT.start + ts.len - 1)-med, 3], col="red", lty=3)
plot(-10, 0, xlab = "", ylab = "", xlim=c(0.05,2), ylim=c(-1.5,3.5))
title(xlab = "Age (Ma)", line = 2.75)
title(ylab = expression("BWT ("*degree*" C)"), line = 2.75)
for(i in seq(1, sims, by = max(floor(sims / 2500),1))){
lines(ts.ages, sl$BWT[i,]-med, col = rgb(0,0,0, 0.01))
}
lines(ts.ages, su[BWT.start:(BWT.start + ts.len - 1), 5]-med, col="red")
lines(ts.ages, su[BWT.start:(BWT.start + ts.len - 1), 3]-med, col="red", lty=3)
lines(ts.ages, su[BWT.start:(BWT.start + ts.len - 1), 7]-med, col="red", lty=3)
quants = matrix(double(), nrow = 3, ncol = 361)
for(j in 1:361){
quants[,j] = quantile(BWT.delta, c(0.025,0.5,0.975))
}
for(j in 1:361){
quants[,j] = quantile(BWT.delta[,j], c(0.025,0.5,0.975))
}
View(quants)
lines(ts.ages, quants[,2], col="blue")
lines(ts.ages, quants[2,], col="blue")
lines(ts.ages, quants[1,], col="blue", lty=3)
lines(ts.ages, quants[3,], col="blue", lty=3)
#These use data from Multi run
prep.multi()
#Shorthand
sl = post.multi$BUGSoutput$sims.list
su = post.multi$BUGSoutput$summary
#Get some indicies
sims = nrow(sl$BWT.b)
BWT.b.start = match("BWT.b[1]", row.names(su))
d18O.b.start = match("d18O_sw.b[1]", row.names(su))
BWT.e.start = match("BWT.e[1]", row.names(su))
d18O.e.start = match("d18O_sw.e[1]", row.names(su))
#Setup
png("Figure4.png", units="in", width=5, height=5, res=300)
layout(matrix(c(1,2), 2, 1), heights = c(lcm(2.1*2.54), lcm(2.9*2.54)))
par(mai=c(0.2,1,0.2,0.2), cex=0.85)
#First panel w BWT
plot(-10, 0, xlab = "", ylab = expression("BWT ("*degree*" C)"),
xlim=c(1239,1315), ylim=c(-3,8), axes = FALSE)
axis(1, labels=FALSE)
axis(2)
box()
for(i in seq(1, sims, by = max(floor(sims / 2500),1))){
lines(ts.ages, sl$BWT.b[i,], col = rgb(0.5,0,0, 0.01))
}
for(i in seq(1, sims, by = max(floor(sims / 2500),1))){
lines(ts.ages, sl$BWT.e[i,], col = rgb(0,0,1, 0.01))
}
lines(ts.ages, su[BWT.b.start:(BWT.b.start + ts.len - 1), 5], col="red")
lines(ts.ages, su[BWT.b.start:(BWT.b.start + ts.len - 1), 3], col="red", lty=3)
lines(ts.ages, su[BWT.b.start:(BWT.b.start + ts.len - 1), 7], col="red", lty=3)
lines(ts.ages, su[BWT.e.start:(BWT.e.start + ts.len - 1), 5], col=rgb(0,0,0.7))
lines(ts.ages, su[BWT.e.start:(BWT.e.start + ts.len - 1), 3], col=rgb(0,0,0.7), lty=3)
lines(ts.ages, su[BWT.e.start:(BWT.e.start + ts.len - 1), 7], col=rgb(0,0,0.7), lty=3)
xl = par("usr")[1]+(par("usr")[2]-par("usr")[1])/25
yl = par("usr")[4]-(par("usr")[4]-par("usr")[3])/15
text(xl, yl, "A")
#Second panel for seawater d18O
par(mai=c(1,1,0.2,0.2))
plot(-10, 0, xlab = "Age (ka)", ylab = expression(delta^{18}*"O"[sw]*" (\u2030, VSMOW)"),
xlim=c(1239,1315), ylim=c(1.5,-0.6))
for(i in seq(1, sims, by = max(floor(sims / 2500),1))){
lines(ts.ages, sl$d18O_sw.b[i,], col = rgb(0.5,0,0, 0.01))
}
for(i in seq(1, sims, by = max(floor(sims / 2500),1))){
lines(ts.ages, sl$d18O_sw.e[i,], col = rgb(0,0,1, 0.01))
}
lines(ts.ages, su[d18O.b.start:(d18O.b.start+ts.len-1), 5], col="red")
lines(ts.ages, su[d18O.b.start:(d18O.b.start+ts.len-1), 3], col="red", lty=3)
lines(ts.ages, su[d18O.b.start:(d18O.b.start+ts.len-1), 7], col="red", lty=3)
lines(ts.ages, su[d18O.e.start:(d18O.e.start+ts.len-1), 5], col=rgb(0,0,0.7))
lines(ts.ages, su[d18O.e.start:(d18O.e.start+ts.len-1), 3], col=rgb(0,0,0.7), lty=3)
lines(ts.ages, su[d18O.e.start:(d18O.e.start+ts.len-1), 7], col=rgb(0,0,0.7), lty=3)
xl = par("usr")[1]+(par("usr")[2]-par("usr")[1])/25
yl = par("usr")[4]-(par("usr")[4]-par("usr")[3])/15
text(xl, yl, "B")
dev.off()
##These first plots use the Lear data, so prep it using the function above
prep.lear()
#Shorthand
sl = post.lear$BUGSoutput$sims.list
su = post.lear$BUGSoutput$summary
#Get some indicies
sims = nrow(sl$BWT)
BWT.start = match("BWT[1]", row.names(su))
d18O.start = match("d18O_sw[1]", row.names(su))
MgCa.start = match("MgCa_sw_m[1]", row.names(su))
png("Figure2.png", units="in", width=5, height=5, res=300)
layout(matrix(c(1,2), 2, 1), heights = c(lcm(2.1*2.54), lcm(2.9*2.54)))
par(mai=c(0.2,1,0.2,0.2), cex=0.85)
plot(-10, 0, xlab = "", ylab = expression("BWT ("*degree*" C)"),
xlim=c(0,18), ylim=c(-3,9), axes = FALSE)
axis(1, labels=FALSE)
axis(2)
box()
for(i in seq(1, sims, by = max(floor(sims / 2500),1))){
lines(ts.ages, sl$BWT[i,], col = rgb(0,0,0, 0.01))
}
lines(ts.ages, su[BWT.start:(BWT.start + ts.len - 1), 5], col="red")
lines(ts.ages, su[BWT.start:(BWT.start + ts.len - 1), 3], col="red", lty=3)
lines(ts.ages, su[BWT.start:(BWT.start + ts.len - 1), 7], col="red", lty=3)
tp = d_mgca[order(d_mgca$Age.Ma), "Age.Ma"]
points(tp, rep(-3, nrow(d_mgca)), pch=21, bg = "white")
xl = par("usr")[1]+(par("usr")[2]-par("usr")[1])/25
yl = par("usr")[4]-(par("usr")[4]-par("usr")[3])/15
text(xl, yl, "A")
#Second panel for seawater d18O
par(mai=c(1,1,0.2,0.2))
plot(-10, 0, xlab = "Age (Ma)", ylab = expression(delta^{18}*"O"[sw]*" (\u2030, VSMOW)"),
xlim=c(0,18), ylim=c(2,-1.5))
for(i in seq(1, sims, by = max(floor(sims / 2500),1))){
lines(ts.ages, sl$d18O_sw[i,], col = rgb(0,0,0, 0.01))
}
lines(ts.ages, su[d18O.start:(d18O.start+ts.len-1), 5], col="red")
lines(ts.ages, su[d18O.start:(d18O.start+ts.len-1), 3], col="red", lty=3)
lines(ts.ages, su[d18O.start:(d18O.start+ts.len-1), 7], col="red", lty=3)
#lines(ts.ages, su[d18O.start:(d18O.start+ts.len-1), 4], col="red", lty=2)
#lines(ts.ages, su[d18O.start:(d18O.start+ts.len-1), 6], col="red", lty=2)
op = d_o[order(d_o$Age.Ma),"Age.Ma"]
points(op, rep(2, nrow(d_o)), pch=21, bg = "white")
xl = par("usr")[1]+(par("usr")[2]-par("usr")[1])/25
yl = par("usr")[4]-(par("usr")[4]-par("usr")[3])/15
text(xl, yl, "B")
dev.off()
