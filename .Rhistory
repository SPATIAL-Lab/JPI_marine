png("downloads.png", width=6, height=4, units="in", res=300)
par(mai = c(1,1,0.4,0.4))
plot(byDate$Date, byDate$cumN, xlab = "Date", ylab = "Cumulative Downloads", type = "l", lwd=2)
dev.off()
channel = odbcConnect("WIDB")
library(RODBC)
channel = odbcConnect("WIDB")
sqlQuery(channel, "SELCT * FROM Samples WHERE Sample_ID LIKE 'GJBMISC18%'")
sqlQuery(channel, "SELECT * FROM Samples WHERE Sample_ID LIKE 'GJBMISC18%'")
sqlQuery(channel, "SELECT * FROM Water_Isotope_Data WHERE Sample_ID LIKE 'GJBMISC18%'")
sqlQuery(channel, "SELECT * FROM Water_Isotope_Data WHERE Sample_ID LIKE '18-192%'")
smps = sqlQuery(channel, "SELECT * FROM Samples WHERE Sample_ID LIKE 'GJBMISC18%'")
old.ids = smps$Sample_ID[10:14]
old.ids
old.ids = as.character(old.ids)
ids = data.frame(old.ids, "new.ids" = old.ids)
ids
ids$new.ids = paste0("18-192_", ids$new.ids)
ids
?proj4string
library(sp)
?proj4string
?projectRaster
library(raster)
?projectRaster
i=2
paste("UPDATE Samples SET Sample_ID =", ids$new.ids[i], "WHERE Sample_ID =", ids$old.ids[i])
paste("UPDATE Samples SET Sample_ID ='", ids$new.ids[i], "' WHERE Sample_ID ='", ids$old.ids[i], "'")
paste0("UPDATE Samples SET Sample_ID ='", ids$new.ids[i], "' WHERE Sample_ID ='", ids$old.ids[i], "'")
for(i in 1:5){
sqlQuery(channel, paste0("UPDATE Samples SET Sample_ID ='", ids$new.ids[i], "' WHERE Sample_ID ='", ids$old.ids[i], "'"))
}
sqlQuery(channel, "SELECT * FROM Samples WHERE Sample_ID LIKE '18-192%'")
channel = odbcConnect("WIDB")
for(i in 1:5){
sqlQuery(channel, paste0("UPDATE Samples SET Sample_ID ='", ids$new.ids[i], "' WHERE Sample_ID ='", ids$old.ids[i], "'"))
}
sqlQuery(channel, "SELECT * FROM Samples WHERE Sample_ID LIKE '18-192%'")
sqlQuery(channel, "SELECT * FROM Water_Isotope_Data WHERE Sample_ID LIKE '18-192%'")
wi = sqlQuery(channel, "SELECT * FROM Water_Isotope_Data WHERE Sample_ID LIKE '18-192%'")
smps = sqlQuery(channel, "SELECT * FROM Samples WHERE Sample_ID LIKE '18-192%'")
wi$Sample_ID[1]
wi$Sample_ID[1] == smps$Sample_ID[1]
as.character(wi$Sample_ID[1]) == as.character(smps$Sample_ID[1])
View(smps)
View(tmp)
View(wi)
ids
old.ids = sqlQuery(channel, "SELECT Sample_ID FROM Water_Isotope_Data WHERE Sample_ID LIKE '18-192%'")
old.ids
ids$old.ids = old.ids
ids$new.ids[1] = "18-192_GJBMISC18-010"
ids$new.ids[2] = "18-192_GJBMISC18-011"
ids$new.ids[3] = "18-192_GJBMISC18-012"
ids$new.ids[4] = "18-192_GJBMISC18-013"
ids$new.ids[5] = "18-192_GJBMISC18-014"
ids
for(i in 1:5){
sqlQuery(channel, paste0("UPDATE Water_Isotope_Data SET Sample_ID ='", ids$new.ids[i], "' WHERE Sample_ID ='", ids$old.ids[i], "'"))
}
for(i in 1:5){
sqlQuery(channel, paste0("UPDATE Water_Isotope_Data SET Sample_ID ='", ids$new.ids[i], "' WHERE Sample_ID ='", ids$Sample_ID[i], "'"))
}
smps = sqlQuery(channel, "SELECT * FROM Samples WHERE Sample_ID LIKE '18-192%'")
wi = sqlQuery(channel, "SELECT * FROM Water_Isotope_Data WHERE Sample_ID LIKE '18-192%'")
smps$Sample_ID
wi$Sample_ID
ids
paste0("UPDATE Water_Isotope_Data SET Sample_ID ='", ids$new.ids[i], "' WHERE Sample_ID ='", ids$Sample_ID[i], "'")
paste0("UPDATE Water_Isotope_Data SET Sample_ID ='", ids$new.ids[i], "' WHERE Sample_ID ='", ids$old.ids, "'")
names(ids[,1]) = "old.ids"
ids
paste0("UPDATE Water_Isotope_Data SET Sample_ID ='", ids$new.ids[i], "' WHERE Sample_ID ='", ids$old.ids, "'")
for(i in 1:5){
sqlQuery(channel, paste0("UPDATE Water_Isotope_Data SET Sample_ID ='", ids$new.ids[i], "' WHERE Sample_ID ='", ids$old.ids[i], "'"))
}
close(channel)
close(channel)
library(raster)
tst = matrix(,nrow = 500, ncol = 500)
for(i in 1:500){
for(j in 1:500){
tst[i,j] = 10 + 5 * sin(i/60) + (j/100) ^ 2
}
}
tst.r = raster(tst)
e = extent(0.1999,0.7999,0.1999,0.7999)
domain = extract(tst.r, extent)
pol = matrix(c(0.1999, 0.1999, 0.1999, 0.7999, 0.7999, 0.7999, 0.7999,
0.1999, 0.1999, 0.1999), ncol = 2, byrow = TRUE)
pol.pol = Polygon(pol)
pol.pols = Polygons(list(pol.pol), "domain")
pol.sp = SpatialPolygons(list(pol.pols))
domain = extract(tst.r, pol.sp)
sum(domain[[1]])
mean(domain[[1]])
tst = matrix(,nrow = 100, ncol = 100)
for(i in 1:100){
for(j in 1:100){
tst[i,j] = 10 + 5 * sin(i/15) + (j/10)
}
}
tst.r = raster(tst)
plot(tst.r)
xs = runif(50)
ys = runif(50)
dat = data.frame("x" = xs, "y" = ys)
vals = extract(tst.r, dat)
v = rnorm(50)
mean(v)
sd(v)
vals = extract(tst.r, dat)
vals.sig1 = vals + rnorm(50)
vals.sig5 = vals + rnorm(50)*5
vals = extract(tst.r, dat)
vals.sig1 = vals + rnorm(50)
vals.sig3 = vals + rnorm(50)*3
vals = extract(tst.r, dat)
vals.sig1 = vals + rnorm(50)
vals.sig3 = vals + rnorm(50)*3
dat = cbind(dat, vals, vals.sig1, vals.sig5)
write.csv(dat, "C:/Users/gjbowen/Dropbox/HypoMirror/Chao_RBK/synth1.csv")
dat = data.frame("x" = xs, "y" = ys)
for(i in 1:10){
vals = extract(tst.r, dat)
vals = vals + rnorm(50)
dat = cbind(dat, vals)
}
write.csv(dat, "C:/Users/gjbowen/Dropbox/HypoMirror/Chao_RBK/synth2.csv")
dat = data.frame("x" = xs, "y" = ys)
vals = extract(tst.r, dat)
vals.sig1 = vals + rnorm(50)
vals.sig3 = vals + rnorm(50)*3
dat = cbind(dat, vals, vals.sig1, vals.sig5)
write.csv(dat, "C:/Users/gjbowen/Dropbox/HypoMirror/Chao_RBK/synth1.csv")
dat = data.frame("x" = xs, "y" = ys)
for(i in 1:10){
vals = extract(tst.r, dat)
vals = vals + rnorm(50)
dat = cbind(dat, vals)
}
write.csv(dat, "C:/Users/gjbowen/Dropbox/HypoMirror/Chao_RBK/synth2.csv")
coords = dat = data.frame("x" = xs, "y" = ys)
for(i in 1:10){
vals = extract(tst.r, coords)
vals = vals + rnorm(50)
dat = cbind(dat, vals)
}
write.csv(dat, "C:/Users/gjbowen/Dropbox/HypoMirror/Chao_RBK/synth2.csv")
xs = runif(50)
ys = runif(50)
dat = data.frame("x" = xs, "y" = ys)
vals = extract(tst.r, dat)
vals.sig1 = vals + rnorm(50)
vals.sig3 = vals + rnorm(50)*3
dat = cbind(dat, vals, vals.sig1, vals.sig5)
write.csv(dat, "C:/Users/gjbowen/Dropbox/HypoMirror/Chao_RBK/synth.csv")
for(i in 1:10){
xs = runif(50)
ys = runif(50)
dat = data.frame("x" = xs, "y" = ys)
vals = extract(tst.r, dat)
vals = vals + rnorm(50)*2
dat = cbind(dat, vals)
fn = paste0("C:/Users/gjbowen/Dropbox/HypoMirror/Chao_RBK/synth",i,".csv")
write.csv(dat, fn)
}
for(i in 1:10){
xs = runif(50)
ys = runif(50)
dat = data.frame("x" = xs, "y" = ys)
vals = extract(tst.r, dat)
vals = vals + rnorm(50)*1.5
dat = cbind(dat, vals)
fn = paste0("C:/Users/gjbowen/Dropbox/HypoMirror/Chao_RBK/synth",i,".csv")
write.csv(dat, fn)
}
pol = matrix(c(0.2, 0.2, 0.2, 0.8, 0.8, 0.8, 0.8, 0.2, 0.2, 0.2), ncol = 2, byrow = TRUE)
pol.pol = Polygon(pol)
pol.pols = Polygons(list(pol.pol), "domain")
pol.sp = SpatialPolygons(list(pol.pols))
domain = extract(tst.r, pol.sp)
sum(domain[[1]])
mean(domain[[1]])
library(RODBC)
channel = odbcConnect("WIDB")
sqlQuery(channel, "SELECT Site_ID FROM Sites WHERE Country = ' '")
sqlQuery(channel, "UPDATE Sites SET Country = '' WHERE Country = ' '")
sqlQuery(channel, "SELECT Site_ID FROM Sites WHERE Country = ' '")
sqlQuery(channel, "UPDATE Sites SET Country = '' WHERE Country = ' '")
sqlQuery(channel, "UPDATE Sites SET Country = NULL WHERE Country = ' '")
install.packages(devtools)
install.packages("devtools")
library(devtools)
devtools::install_github("SPATIAL-Lab/isorig", force=TRUE)
?Bacon
library(rbacon)
?Bacon
?rbacon
library(devtools)
devtools::install_github("SPATIAL-Lab/isorig", force=T)
library(isOrigin)
d = subOrigData(taxon = "Homo sapiens")
plot(d$Latitude, d$d2H)
data("naMap")
data("d2H_world")
data("d2h_world")
d = subOrigData(taxon = "Homo sapiens", mask = naMap)
plot(d$Latitude, d$d2H)
d = d[d$Latitude < 50,]
plot(d$Latitude, d$d2H)
r = calRaster(d, d2h_world, mask = naMap)
getwd()
id = c("a", "b", "c", "d")
d2h = c(-110, -105, -90, -102)
dd = data.frame(id, d2h)
asn = pdRaster(r$isoscape.rescale$mean,r$isoscape.rescale$sd,unknown=dd,mask=naMap)
p1 <- c(-100,60,-100,65,-110,65,-110,60,-100,60)
p1 <- matrix(p1, 5,2, byrow = T)
p1 <- Polygon(p1)
p1 <- Polygons(list(p1), "p1")
p2 <- c(-100,40,-100,45,-110,45,-110,40,-100,40)
p2 <- matrix(p2, 5,2, byrow = T)
p2 <- Polygon(p2)
p2 <- Polygons(list(p2), "p2")
p12 <- SpatialPolygons(list(p1,p2),1:2)
lines(p12)
polygon(p12)
polygon(p1)
oddsRatio(asn, p12)
qtlRaster(asn, 0.75, thresholdType = 1)
qtlRaster(asn, 0.75, thresholdType = 2)
multRaster(asn)
unionP(asn)
ddd = multRaster(asn)
?SpatialPoints
pts = SpatialPoints(data.frame("Lat"=c(45,55),"Lon"=c(-80,-110)))
plot(pts)
ddd = multRaster(asn)
points(pts)
pts = SpatialPoints(data.frame("Lon"=c(-80,-110), "Lat"=c(45,55)))
points(pts)
oddsRatio(ddd,pts)
pts = data.frame("Lon"=c(-80,-110), "Lat"=c(45,55))
oddsRatio(ddd,pts)
devtools::install_github("SPATIAL-Lab/isorig", force=T)
oddsRatio(ddd,pts)
pts = SpatialPoints(data.frame("Lon"=c(-80,-110), "Lat"=c(45,55)))
oddsRatio(ddd,pts)
unionP(asn)
jointP
jointP(asn)
oddsRatio(asn, p12)
data(isOrigin)
library(isOrigin)
oddsRatio(asn, p12)
library(isOrigin)
data("naMap")
data("d2hworld")
data("d2h_world")
d = subOrigData(taxon = c("Homo sapiens"), mask = naMap)
r = calRaster(dd, d2h_world, mask = naMap)
r = calRaster(d, d2h_world, mask = naMap)
id = c("A", "B", "C", "D")
v = c(-110, -120, -122, -100)
dd = data.frame(id, v)
asn = pdRaster(r, unknown = dd, mask = naMap)
pdRaster
summary(r)
asn = pdRaster(r$isoscape.rescale, unknown = dd, mask = naMap)
jointP(asn)
unionP(asn)
lons = c(-80, -110)
lats = c(40,55)
ll = matrix(c(lons, lats), nrow = 2, ncol = 2, byrow = FALSE)
ll
pts = SpatialPoints(ll)
points(pts)
oddsRatio(asn, pts)
s = oddsRatio(asn, pts)
summary(s)
s=jointP(asn)
qtlRaster(asn, 0.7, 2)
qtlRaster(asn, 0.7, 1)
d
dd
dd = data.frame(id=seq(1,100,1), v=rep(-100,100))
pdRaster(r$isoscape.rescale, dd, mask = naMap)
?pdRaster
pdRaster(r$isoscape.rescale, dd, mask = naMap, genplot = FALSE)
asn = pdRaster(r$isoscape.rescale, dd, mask = naMap, genplot = FALSE)
qtlRaster(asn, 0.7, 1)
unionP(asn)
1500 * 1.6^2
1500 / 1.6^2
library(RODBC)
channel = odbcConnect("WIDB")
sqlQuery(channel, "SELECT * FROM Sites WHERE Site_Name = 'PORTOROZ'")
sqlQuery(channel, "UPDATE Sites SET Latitude=45.475376 WHERE Site_Name = 'PORTOROZ'")
sqlQuery(channel, "UPDATE Sites SET Longitude=13.616026 WHERE Site_Name = 'PORTOROZ'")
sqlQuery(channel, "UPDATE Sites SET Site_Comments='coordinates updated 10/5/18, pers comm, P. Vreca' WHERE Site_Name = 'PORTOROZ'")
sqlQuery(channel, "SELECT * FROM Projects")
close(channel)
library("isOrigin", lib.loc="~/R/win-library/3.4")
remove.packages("isOrigin", lib="~/R/win-library/3.4")
devtools::install_github("SPATIAL-lab/isorig", force =T)
devtools::install_github("SPATIAL-lab/isorig", force =T)
devtools::install_github("SPATIAL-lab/isorig", force =T)
library(isOrigin)
data("naMap")
data("d2h_world")
d = subOrigData(taxon = c("Homo sapiens"), mask = naMap)
d = subOrigData(taxon = c("Homo sapiens"))
d = subOrigData(taxon = c("Homo sapiens"), mask = naMap)
r = calRaster(known = d, isoscape = d2h_world, mask = naMap)
devtools::install_github("SPATIAL-lab/isorig", force =T)
data("naMap")
library(isOrigin)
data("naMap")
data("d2h_world")
d = subOrigData(taxon = c("Homo sapiens"), mask = naMap)
12500*1.525
nr = read.csv("C:/Users/gjbowen/Desktop/receipt_form_D1820181008100705069.csv")
View(nr)
summary(nr)
types(nr)
type(nr)
sd = as.Date(nr$shipmentReceivedDate)
?as.Date
sd = as.Date(nr$shipmentReceivedDate, format = "%M/%D/%Y")
sd = as.Date(nr$shipmentReceivedDate, format = "%m/%D/%Y")
sd
sd = as.Date(nr$shipmentReceivedDate, format = "%m/%d/%Y")
nr$shipmentReceivedDate = sd
write.csv("C:/Users/gjbowen/Desktop/receipt_form_D1820181008100705069B.csv")
write.csv(nr, "C:/Users/gjbowen/Desktop/receipt_form_D1820181008100705069B.csv")
write.csv(nr, "C:/Users/gjbowen/Desktop/receipt_form_D1820181008100705069.csv", row.names = FALSE)
library(R2OpenBUGS)
library(coda)
library(rjags)
library(R2jags)
library(xlsx)
?jags
jags
?adapt
library(R2OpenBUGS)
library(coda)
library(rjags)
library(R2jags)
library(xlsx)
setwd("C:/Users/u0133977/Dropbox/HypoMirror/JPI_marine/")
setwd("C:/Users/u0133977/Dropbox/HypoMirror/JPI_marine/")
setwd("C:/Users/gjbowen/Dropbox/HypoMirror/JPI_marine/")
d = read.csv("elderfield_2012.csv")
max(d$Age_ka)
min(d$Age_ka)
#prep the d18O data and add age indicies
d_o.s = d[!is.na(d$d18O), ]
##Set up timeseries for d18O_sw and BWT modeling
ts.min.s = 1550
ts.max.s = 5
ts.step.s = 1
ts.ages.s = seq(ts.min.s, ts.max.s, -ts.step.s)
ts.len.s = length(ts.ages.s)
o_age.ind.s = round((ts.min.s - d_o.s$Age..ka.BP.) / ts.step.s) + 1
o_age.ind.s = round((ts.min.s - d_o.s$Age_ka) / ts.step.s) + 1
#prep the MgCa data and add age indicies
d_mgca.s = d[!is.na(d$MgCa),]
mgca_age.ind.s = round((ts.min.s - d_mgca.s$Age_ka) / ts.step.s) + 1
#U spp calibration data from Elderfield 2012 compilation
d_mgca_calib.u = read.csv("u_mgca_calib.csv")
#get distributions of sw Mg/Ca from long model - not needed for U spp dataset
load("mg_post.RData") #uses output from MgCa_sw_model.R
mgca_sw_m.neo = mean(mg_post$BUGSoutput$sims.list$MgCa_sw_m[,110])
mgca_sw_sd.neo = sd(mg_post$BUGSoutput$sims.list$MgCa_sw_m[,110])
mgca_sw_neo = c(mgca_sw_m.neo, mgca_sw_sd.neo)
##Parameters to be saved
parameters = c("d18O_sw", "BWT", "BWT.eps.ac", "BWT.pre", "d18O_sw.eps.ac", "d18O_sw.pre",
"lc", "MgCa_calib.pre", "a", "d18O_calib.pre", "d18O_calib.pre.2")
##Data to pass to the model
dat = list(nages = ts.len.s, MgCa_calib.age = d_mgca_calib$Age,
MgCa_calib.bwt.m = d_mgca_calib.u$BWT, MgCa_calib.bwt.sd = rep(0.2, nrow(d_mgca_calib.u)), MgCa_calib = d_mgca_calib.u$MgCa,
d18O_calib.bwt.m = d_d18O_calib$Temperature_C, d18O_calib.bwt.sd = rep(0.2,nrow(d_d18O_calib)), d18O_calib = d_d18O_calib$C.SW_d18O,
MgCa_sw.neo = mgca_sw_neo,
MgCa.age.ind = mgca_age.ind.s, MgCa = d_mgca.s$U..peregerina.Mg.Ca..mmol.mol.,
d18O.age.ind = o_age.ind.s, d18O = d_o.s$C..wuellerstorfi.d18O..per.mil.PDB.)
##Data to pass to the model
dat = list(nages = ts.len.s,
MgCa_calib.bwt.m = d_mgca_calib.u$BWT, MgCa_calib.bwt.sd = rep(0.2, nrow(d_mgca_calib.u)), MgCa_calib = d_mgca_calib.u$MgCa,
d18O_calib.bwt.m = d_d18O_calib$Temperature_C, d18O_calib.bwt.sd = rep(0.2,nrow(d_d18O_calib)), d18O_calib = d_d18O_calib$C.SW_d18O,
MgCa_sw.neo = mgca_sw_neo,
MgCa.age.ind = mgca_age.ind.s, MgCa = d_mgca.s$U..peregerina.Mg.Ca..mmol.mol.,
d18O.age.ind = o_age.ind.s, d18O = d_o.s$C..wuellerstorfi.d18O..per.mil.PDB.)
source("helpers.R")
##Set up timeseries for d18O_sw and BWT modeling
ts.min = 18
ts.max = 0
ts.step = 0.05
ts.ages = seq(ts.min, ts.max, -ts.step)
ts.len = length(ts.ages)
##Prep the foram data, first read
d = read.csv("Lear_combined.csv")
##Now split out the d18O data and strip one outlier
d_o = d[!is.na(d$d18O),]
d_o = d_o[d_o$Sample.ID != "806B 47-5 38-43",]
#Timeseries index for each d18O sample
o_age.ind = round((ts.min - d_o$Age.Ma) / ts.step) + 1
##Now split out the MgCa data and get TS index
d_mgca = d[!is.na(d$MgCa),]
mgca_age.ind = round((ts.min - d_mgca$Age.Ma) / ts.step) + 1
##Set up timeseries for MgCa_sw modeling
mgca_ts.min = 110
mgca_ts.max = 0
mgca_ts.step = 1
mgca_ts.ages = seq(mgca_ts.min, mgca_ts.max, -mgca_ts.step)
mgca_ts.len = length(mgca_ts.ages)
##Read in paleo-seawater MgCa data
d_mgca_sw = read.csv("mgca_sw.csv")
##Age index for seawater MgCa samples
mgca_sw_age.ind = round((mgca_ts.min - d_mgca_sw$Age) / mgca_ts.step) + 1
##Add indicies for seawater MgCa TS to MgCa foram data
mgca_age.ind.sw = round((mgca_ts.min - d_mgca$Age.Ma) / mgca_ts.step) + 1
mgca_age.ind.all = matrix(c(mgca_age.ind, mgca_age.ind.sw), ncol = 2)
##Read in MgCa calibration dataset
d_mgca_calib = read.csv("mgca_calib.csv")
##Age index for MgCa calibration samples
mgca_calib_age.ind = round((mgca_ts.min - d_mgca_calib$Age) / mgca_ts.step) + 1
##Read in d18O calibration dataset
d_d18O_calib = read.csv("C_comp.csv")
d_d18O_calib = d_d18O_calib[is.na(d_d18O_calib$Ignore),]
d = read.csv("elderfield_2012.csv")
##Set up timeseries for d18O_sw and BWT modeling
ts.min.s = 1550
ts.max.s = 5
ts.step.s = 1
ts.ages.s = seq(ts.min.s, ts.max.s, -ts.step.s)
ts.len.s = length(ts.ages.s)
#prep the d18O data and add age indicies
d_o.s = d[!is.na(d$d18O), ]
o_age.ind.s = round((ts.min.s - d_o.s$Age_ka) / ts.step.s) + 1
#prep the MgCa data and add age indicies
d_mgca.s = d[!is.na(d$MgCa),]
mgca_age.ind.s = round((ts.min.s - d_mgca.s$Age_ka) / ts.step.s) + 1
#U spp calibration data from Elderfield 2012 compilation
d_mgca_calib.u = read.csv("u_mgca_calib.csv")
#get distributions of sw Mg/Ca from long model - not needed for U spp dataset
load("mg_post.RData") #uses output from MgCa_sw_model.R
mgca_sw_m.neo = mean(mg_post$BUGSoutput$sims.list$MgCa_sw_m[,110])
mgca_sw_sd.neo = sd(mg_post$BUGSoutput$sims.list$MgCa_sw_m[,110])
mgca_sw_neo = c(mgca_sw_m.neo, mgca_sw_sd.neo)
##Parameters to be saved
parameters = c("d18O_sw", "BWT", "BWT.eps.ac", "BWT.pre", "d18O_sw.eps.ac", "d18O_sw.pre",
"lc", "MgCa_calib.pre", "a", "d18O_calib.pre", "d18O_calib.pre.2")
##Data to pass to the model
dat = list(nages = ts.len.s,
MgCa_calib.bwt.m = d_mgca_calib.u$BWT, MgCa_calib.bwt.sd = rep(0.2, nrow(d_mgca_calib.u)), MgCa_calib = d_mgca_calib.u$MgCa,
d18O_calib.bwt.m = d_d18O_calib$Temperature_C, d18O_calib.bwt.sd = rep(0.2,nrow(d_d18O_calib)), d18O_calib = d_d18O_calib$C.SW_d18O,
MgCa_sw.neo = mgca_sw_neo,
MgCa.age.ind = mgca_age.ind.s, MgCa = d_mgca.s$U..peregerina.Mg.Ca..mmol.mol.,
d18O.age.ind = o_age.ind.s, d18O = d_o.s$C..wuellerstorfi.d18O..per.mil.PDB.)
t1 = proc.time()
set.seed(t1[3])
post = jags.parallel(model.file = "split_temporal_short.R", parameters.to.save = parameters,
data = dat, n.chains=3, n.iter = 25000,
n.burnin = 5000, n.thin = 25)
proc.time() - t1
library(R2OpenBUGS)
library(coda)
library(rjags)
library(R2jags)
library(xlsx)
t1 = proc.time()
set.seed(t1[3])
post = jags.parallel(model.file = "split_temporal_elderfield.R", parameters.to.save = parameters,
data = dat, n.chains=3, n.iter = 25000,
n.burnin = 5000, n.thin = 25)
proc.time() - t1
d_d18O_calib
##Data to pass to the model
dat = list(nages = ts.len.s,
MgCa_calib.bwt.m = d_mgca_calib.u$BWT, MgCa_calib.bwt.sd = rep(0.2, nrow(d_mgca_calib.u)), MgCa_calib = d_mgca_calib.u$MgCa,
d18O_calib.bwt.m = d_d18O_calib$Temperature_C, d18O_calib.bwt.sd = rep(0.2,nrow(d_d18O_calib)), d18O_calib = d_d18O_calib$C.SW_d18O,
MgCa_sw.neo = mgca_sw_neo,
MgCa.age.ind = mgca_age.ind.s, MgCa = d_mgca.s$MgCa,
d18O.age.ind = o_age.ind.s, d18O = d_o.s$d18O)
##Run the inversion
t1 = proc.time()
set.seed(t1[3])
post = jags.parallel(model.file = "split_temporal_elderfield.R", parameters.to.save = parameters,
data = dat, n.chains=3, n.iter = 25000,
n.burnin = 5000, n.thin = 25)
proc.time() - t1
d_mgca.s[1485,]
d_mgca.s[1450:,]
d_mgca.s[>1450,]
d_mgca.s[1450:*,]
mgca_age.ind.s[1485]
MgCa.age.ind = mgca_age.ind.s
MgCa_sw.neo = mgca_sw_neo
MgCa_sw.neo[1]
i=1485
MgCa_sw.neo[1] + (0.3 - MgCa_sw.neo[1]) *  MgCa.age.ind[i]
0.3 - MgCa_sw.neo[1]
nages = ts.len.s
nages
MgCa.age.ind[i] / (nages)
MgCa_sw.neo[1] + (0.3 - MgCa_sw.neo[1]) *  MgCa.age.ind[i] / (nages)
MgCa_sw.neo[2] + (0.3 - MgCa_sw.neo[2]) *  MgCa.age.ind[i] / (nages)
MgCa_sw.neo[1] + (0.3 - MgCa_sw.neo[1]) *  MgCa.age.ind[i] / (nages)
MgCa_sw.neo[1] + (5.2 - MgCa_sw.neo[1]) *  MgCa.age.ind[i] / (nages)
MgCa_sw.neo[1]
MgCa.age.ind[i]
