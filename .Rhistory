##Big old calibration figure
png("calibration.png", res = 300, units = "in", width = 8, height = 4)
layout(matrix(c(1,2,3,4,5,6,7,8), nrow = 2, ncol = 4, byrow=TRUE))
par(mai=c(0.5,0.5,0.1,0.1))
xoff = 2.3
#MgCa calibration parms
plotd(sl$lc[,1], col="red")
lined(rnorm(100000, 1.5, 0.1))
title(xlab=expression(paste(alpha[1])), line = xoff)
plotd(sl$lc[,2], col="red", ylab="")
lined(rnorm(100000, 0.1, 0.01))
title(xlab=expression(paste(alpha[1])), line = xoff)
plotd(sl$lc[,3], col="red", ylab="")
lined(rnorm(100000, -0.02, 0.03))
title(xlab=expression(paste(alpha[1])), line = xoff)
plotd(sqrt(1/(sl$MgCa_calib.pre)), col="red", xlim=c(0.05,0.25), ylab="")
lined(sqrt(1/(rgamma(100000, 2, 1/30))))
title(xlab=expression(paste(sigma["MgCaf"])), line = xoff)
#d18O calibration parms
plotd(sl$a[,1], col="red")
lined(rnorm(100000, 3.32, 0.02))
title(xlab=expression(paste(beta[1])), line = xoff)
plotd(sl$a[,2], col="red", ylab="")
lined(rnorm(100000, -0.237, 0.01))
title(xlab=expression(paste(beta[2])), line = xoff)
plotd(sl$a[,3], col="red", ylab="")
lined(rnorm(100000, 0.001, 0.0005))
title(xlab=expression(paste(beta[3])), line = xoff)
plotd(sqrt(1/(sl$d18O_calib.pre)), col="red", xlim=c(0.05,0.25), ylab="")
lined(sqrt(1/(rgamma(100000, 3, 1/30))))
title(xlab=expression(paste(sigma[paste(delta, "18Of")])), line = xoff)
dev.off()
xl =
yl = par("usr")[3]-(par("usr")[3]-par("usr")[1])/20
par("usr")[3]
#MgCa calibration parms
plotd(sl$lc[,1], col="red")
xl =
yl = par("usr")[3]-(par("usr")[3]-par("usr")[1])/20
par("usr")[3]
par("usr")[2]
par("usr")[1]
xl = par("usr")[1]+(par("usr")[2]-par("usr")[1])/20
yl = par("usr")[4]-(par("usr")[4]-par("usr")[3])/20
text("A", xl, yl)
text(xl, yl, "A")
png("calibration.png", res = 300, units = "in", width = 8, height = 4)
layout(matrix(c(1,2,3,4,5,6,7,8), nrow = 2, ncol = 4, byrow=TRUE))
par(mai=c(0.5,0.5,0.1,0.1))
xoff = 2.3
#MgCa calibration parms
plotd(sl$lc[,1], col="red")
lined(rnorm(100000, 1.5, 0.1))
title(xlab=expression(paste(alpha[1])), line = xoff)
xl = par("usr")[1]+(par("usr")[2]-par("usr")[1])/20
yl = par("usr")[4]-(par("usr")[4]-par("usr")[3])/20
text(xl, yl, "A")
plotd(sl$lc[,2], col="red", ylab="")
lined(rnorm(100000, 0.1, 0.01))
title(xlab=expression(paste(alpha[1])), line = xoff)
plotd(sl$lc[,3], col="red", ylab="")
lined(rnorm(100000, -0.02, 0.03))
title(xlab=expression(paste(alpha[1])), line = xoff)
plotd(sqrt(1/(sl$MgCa_calib.pre)), col="red", xlim=c(0.05,0.25), ylab="")
lined(sqrt(1/(rgamma(100000, 2, 1/30))))
title(xlab=expression(paste(sigma["MgCaf"])), line = xoff)
#d18O calibration parms
plotd(sl$a[,1], col="red")
lined(rnorm(100000, 3.32, 0.02))
title(xlab=expression(paste(beta[1])), line = xoff)
plotd(sl$a[,2], col="red", ylab="")
lined(rnorm(100000, -0.237, 0.01))
title(xlab=expression(paste(beta[2])), line = xoff)
plotd(sl$a[,3], col="red", ylab="")
lined(rnorm(100000, 0.001, 0.0005))
title(xlab=expression(paste(beta[3])), line = xoff)
plotd(sqrt(1/(sl$d18O_calib.pre)), col="red", xlim=c(0.05,0.25), ylab="")
lined(sqrt(1/(rgamma(100000, 3, 1/30))))
title(xlab=expression(paste(sigma[paste(delta, "18Of")])), line = xoff)
dev.off()
png("calibration.png", res = 300, units = "in", width = 8, height = 4)
layout(matrix(c(1,2,3,4,5,6,7,8), nrow = 2, ncol = 4, byrow=TRUE))
par(mai=c(0.5,0.5,0.1,0.1))
xoff = 2.3
#MgCa calibration parms
plotd(sl$lc[,1], col="red")
lined(rnorm(100000, 1.5, 0.1))
title(xlab=expression(paste(alpha[1])), line = xoff)
xl = par("usr")[1]+(par("usr")[2]-par("usr")[1])/10
yl = par("usr")[4]-(par("usr")[4]-par("usr")[3])/10
text(xl, yl, "A")
plotd(sl$lc[,2], col="red", ylab="")
lined(rnorm(100000, 0.1, 0.01))
title(xlab=expression(paste(alpha[1])), line = xoff)
plotd(sl$lc[,3], col="red", ylab="")
lined(rnorm(100000, -0.02, 0.03))
title(xlab=expression(paste(alpha[1])), line = xoff)
plotd(sqrt(1/(sl$MgCa_calib.pre)), col="red", xlim=c(0.05,0.25), ylab="")
lined(sqrt(1/(rgamma(100000, 2, 1/30))))
title(xlab=expression(paste(sigma["MgCaf"])), line = xoff)
#d18O calibration parms
plotd(sl$a[,1], col="red")
lined(rnorm(100000, 3.32, 0.02))
title(xlab=expression(paste(beta[1])), line = xoff)
plotd(sl$a[,2], col="red", ylab="")
lined(rnorm(100000, -0.237, 0.01))
title(xlab=expression(paste(beta[2])), line = xoff)
plotd(sl$a[,3], col="red", ylab="")
lined(rnorm(100000, 0.001, 0.0005))
title(xlab=expression(paste(beta[3])), line = xoff)
plotd(sqrt(1/(sl$d18O_calib.pre)), col="red", xlim=c(0.05,0.25), ylab="")
lined(sqrt(1/(rgamma(100000, 3, 1/30))))
title(xlab=expression(paste(sigma[paste(delta, "18Of")])), line = xoff)
dev.off()
png("calibration.png", res = 300, units = "in", width = 8, height = 4)
layout(matrix(c(1,2,3,4,5,6,7,8), nrow = 2, ncol = 4, byrow=TRUE))
par(mai=c(0.5,0.5,0.1,0.1))
xoff = 2.3
#MgCa calibration parms
plotd(sl$lc[,1], col="red")
lined(rnorm(100000, 1.5, 0.1))
title(xlab=expression(paste(alpha[1])), line = xoff)
xl = par("usr")[1]+(par("usr")[2]-par("usr")[1])/15
yl = par("usr")[4]-(par("usr")[4]-par("usr")[3])/15
text(xl, yl, "A")
plotd(sl$lc[,2], col="red", ylab="")
lined(rnorm(100000, 0.1, 0.01))
title(xlab=expression(paste(alpha[1])), line = xoff)
plotd(sl$lc[,3], col="red", ylab="")
lined(rnorm(100000, -0.02, 0.03))
title(xlab=expression(paste(alpha[1])), line = xoff)
plotd(sqrt(1/(sl$MgCa_calib.pre)), col="red", xlim=c(0.05,0.25), ylab="")
lined(sqrt(1/(rgamma(100000, 2, 1/30))))
title(xlab=expression(paste(sigma["MgCaf"])), line = xoff)
#d18O calibration parms
plotd(sl$a[,1], col="red")
lined(rnorm(100000, 3.32, 0.02))
title(xlab=expression(paste(beta[1])), line = xoff)
plotd(sl$a[,2], col="red", ylab="")
lined(rnorm(100000, -0.237, 0.01))
title(xlab=expression(paste(beta[2])), line = xoff)
plotd(sl$a[,3], col="red", ylab="")
lined(rnorm(100000, 0.001, 0.0005))
title(xlab=expression(paste(beta[3])), line = xoff)
plotd(sqrt(1/(sl$d18O_calib.pre)), col="red", xlim=c(0.05,0.25), ylab="")
lined(sqrt(1/(rgamma(100000, 3, 1/30))))
title(xlab=expression(paste(sigma[paste(delta, "18Of")])), line = xoff)
dev.off()
png("calibration.png", res = 300, units = "in", width = 8, height = 4)
layout(matrix(c(1,2,3,4,5,6,7,8), nrow = 2, ncol = 4, byrow=TRUE))
par(mai=c(0.5,0.5,0.1,0.1))
xoff = 2.3
#MgCa calibration parms
plotd(sl$lc[,1], col="red")
lined(rnorm(100000, 1.5, 0.1))
title(xlab=expression(paste(alpha[1])), line = xoff)
xl = par("usr")[1]+(par("usr")[2]-par("usr")[1])/15
yl = par("usr")[4]-(par("usr")[4]-par("usr")[3])/15
text(xl, yl, "A")
plotd(sl$lc[,2], col="red", ylab="")
lined(rnorm(100000, 0.1, 0.01))
title(xlab=expression(paste(alpha[1])), line = xoff)
xl = par("usr")[1]+(par("usr")[2]-par("usr")[1])/15
yl = par("usr")[4]-(par("usr")[4]-par("usr")[3])/15
text(xl, yl, "B")
plotd(sl$lc[,3], col="red", ylab="")
lined(rnorm(100000, -0.02, 0.03))
title(xlab=expression(paste(alpha[1])), line = xoff)
xl = par("usr")[1]+(par("usr")[2]-par("usr")[1])/15
yl = par("usr")[4]-(par("usr")[4]-par("usr")[3])/15
text(xl, yl, "C")
plotd(sqrt(1/(sl$MgCa_calib.pre)), col="red", xlim=c(0.05,0.25), ylab="")
lined(sqrt(1/(rgamma(100000, 2, 1/30))))
title(xlab=expression(paste(sigma["MgCaf"])), line = xoff)
xl = par("usr")[1]+(par("usr")[2]-par("usr")[1])/15
yl = par("usr")[4]-(par("usr")[4]-par("usr")[3])/15
text(xl, yl, "D")
#d18O calibration parms
plotd(sl$a[,1], col="red")
lined(rnorm(100000, 3.32, 0.02))
title(xlab=expression(paste(beta[1])), line = xoff)
xl = par("usr")[1]+(par("usr")[2]-par("usr")[1])/15
yl = par("usr")[4]-(par("usr")[4]-par("usr")[3])/15
text(xl, yl, "E")
plotd(sl$a[,2], col="red", ylab="")
lined(rnorm(100000, -0.237, 0.01))
title(xlab=expression(paste(beta[2])), line = xoff)
xl = par("usr")[1]+(par("usr")[2]-par("usr")[1])/15
yl = par("usr")[4]-(par("usr")[4]-par("usr")[3])/15
text(xl, yl, "F")
plotd(sl$a[,3], col="red", ylab="")
lined(rnorm(100000, 0.001, 0.0005))
title(xlab=expression(paste(beta[3])), line = xoff)
xl = par("usr")[1]+(par("usr")[2]-par("usr")[1])/15
yl = par("usr")[4]-(par("usr")[4]-par("usr")[3])/15
text(xl, yl, "G")
plotd(sqrt(1/(sl$d18O_calib.pre)), col="red", xlim=c(0.05,0.25), ylab="")
lined(sqrt(1/(rgamma(100000, 3, 1/30))))
title(xlab=expression(paste(sigma[paste(delta, "18Of")])), line = xoff)
xl = par("usr")[1]+(par("usr")[2]-par("usr")[1])/15
yl = par("usr")[4]-(par("usr")[4]-par("usr")[3])/15
text(xl, yl, "H")
dev.off()
#This is the Pleistocene foram d18O sd estimate
plotd(sqrt(1/(sl$d18O_calib.pre.2)), col="red", xlim=c(0.05,0.25), ylab="")
#This is the Pleistocene foram d18O sd estimate
plotd(sqrt(1/(sl$d18O_calib.pre.2)), col="red", ylab="")
lined(sqrt(1/(rgamma(100000, 6, 1))))
#This is the Pleistocene foram d18O sd estimate
plotd(sqrt(1/(sl$d18O_calib.pre.2)), col="red", ylab="", xlim=c(0.25,0.6))
lined(sqrt(1/(rgamma(100000, 6, 1))))
#This is the Pleistocene foram d18O sd estimate
plotd(sqrt(1/(sl$d18O_calib.pre.2)), col="red", ylab="", xlim=c(0.25,0.7))
lined(sqrt(1/(rgamma(100000, 6, 1))))
plotd(sqrt(1/(sl$d18O_calib.pre)), col="red", xlim=c(0.05,0.7), ylab="")
lined(sqrt(1/(sl$d18O_calib.pre.2)), col="red", lty=2)
lined(sqrt(1/(rgamma(100000, 3, 1/30))))
lined(sqrt(1/(rgamma(100000, 6, 1))), lty=2)
##Big old calibration figure
png("calibration.png", res = 300, units = "in", width = 8, height = 4)
layout(matrix(c(1,2,3,4,5,6,7,8), nrow = 2, ncol = 4, byrow=TRUE))
par(mai=c(0.5,0.5,0.1,0.1))
xoff = 2.3
#MgCa calibration parms
plotd(sl$lc[,1], col="red")
lined(rnorm(100000, 1.5, 0.1))
title(xlab=expression(paste(alpha[1])), line = xoff)
xl = par("usr")[1]+(par("usr")[2]-par("usr")[1])/15
yl = par("usr")[4]-(par("usr")[4]-par("usr")[3])/15
text(xl, yl, "A")
plotd(sl$lc[,2], col="red", ylab="")
lined(rnorm(100000, 0.1, 0.01))
title(xlab=expression(paste(alpha[1])), line = xoff)
xl = par("usr")[1]+(par("usr")[2]-par("usr")[1])/15
yl = par("usr")[4]-(par("usr")[4]-par("usr")[3])/15
text(xl, yl, "B")
plotd(sl$lc[,3], col="red", ylab="")
lined(rnorm(100000, -0.02, 0.03))
title(xlab=expression(paste(alpha[1])), line = xoff)
xl = par("usr")[1]+(par("usr")[2]-par("usr")[1])/15
yl = par("usr")[4]-(par("usr")[4]-par("usr")[3])/15
text(xl, yl, "C")
plotd(sqrt(1/(sl$MgCa_calib.pre)), col="red", xlim=c(0.05,0.25), ylab="")
lined(sqrt(1/(rgamma(100000, 2, 1/30))))
title(xlab=expression(paste(sigma["MgCaf"])), line = xoff)
xl = par("usr")[1]+(par("usr")[2]-par("usr")[1])/15
yl = par("usr")[4]-(par("usr")[4]-par("usr")[3])/15
text(xl, yl, "D")
#d18O calibration parms
plotd(sl$a[,1], col="red")
lined(rnorm(100000, 3.32, 0.02))
title(xlab=expression(paste(beta[1])), line = xoff)
xl = par("usr")[1]+(par("usr")[2]-par("usr")[1])/15
yl = par("usr")[4]-(par("usr")[4]-par("usr")[3])/15
text(xl, yl, "E")
plotd(sl$a[,2], col="red", ylab="")
lined(rnorm(100000, -0.237, 0.01))
title(xlab=expression(paste(beta[2])), line = xoff)
xl = par("usr")[1]+(par("usr")[2]-par("usr")[1])/15
yl = par("usr")[4]-(par("usr")[4]-par("usr")[3])/15
text(xl, yl, "F")
plotd(sl$a[,3], col="red", ylab="")
lined(rnorm(100000, 0.001, 0.0005))
title(xlab=expression(paste(beta[3])), line = xoff)
xl = par("usr")[1]+(par("usr")[2]-par("usr")[1])/15
yl = par("usr")[4]-(par("usr")[4]-par("usr")[3])/15
text(xl, yl, "G")
plotd(sqrt(1/(sl$d18O_calib.pre)), col="red", xlim=c(0.05,0.7), ylab="")
lined(sqrt(1/(sl$d18O_calib.pre.2)), col="red", lty=2)
lined(sqrt(1/(rgamma(100000, 3, 1/30))))
lined(sqrt(1/(rgamma(100000, 6, 1))), lty=2)
title(xlab=expression(paste(sigma[paste(delta, "18Of")])), line = xoff)
xl = par("usr")[1]+(par("usr")[2]-par("usr")[1])/15
yl = par("usr")[4]-(par("usr")[4]-par("usr")[3])/15
text(xl, yl, "H")
dev.off()
#Let's look at covariance for some parms
smoothScatter(sl$a[,1], sl$a[,2])
smoothScatter(sl$a[,1], sl$a[,3])
smoothScatter(sl$a[,2], sl$a[,3])
#Let's look at covariance for some parms
smoothScatter(sl$lc[,1], sl$lc[,2])
smoothScatter(sl$lc[,1], sl$lc[,3])
smoothScatter(sl$lc[,2], sl$lc[,3])
#BWT TS SD
plotd(sqrt(1/sl$BWT.pre), col="red", xlab="BWT TS standard deviation")
lined(sqrt(1/rgamma(100000, 20, 2)))
#d18O TS SD
plotd(sqrt(1/(sl$d18O_sw.pre)), col="red", xlim = c(0.075, 0.21), xlab="d18O TS standard deviation")
lined(sqrt(1/(rgamma(100000, 10, 1/5))))
#MgCasw TS SD
plotd(sqrt(1/(sl$MgCa_sw_m.pre)), col="red")
lined(sqrt(1/(rgamma(100000, 1000, 0.01))))
#BWT and d18O timeseries autocorrelation
plotd(sl$BWT.eps.ac, col="red", ylim=c(0,20), xlab="TS autocorrelation")
lined(sl$d18O_sw.eps.ac, col="red", lty=2)
#d18O TS SD
plotd(sqrt(1/(sl$d18O_sw.pre)), col="red", xlim = c(0.075, 0.21))
lined(sqrt(1/(rgamma(100000, 10, 1/5))))
title(xlab=expression(paste(sigma, ",", delta^{18}, "O time series", line=xoff)))
title(xlab=expression(paste(sigma, ", ", delta^{18}, "O time series"), line=xoff))
#BWT TS SD
plotd(sqrt(1/sl$BWT.pre), col="red")
lined(sqrt(1/rgamma(100000, 20, 2)))
title(xlab=expression(paste(sigma, ", BWT time series")), line=xoff)
#d18O TS SD
plotd(sqrt(1/(sl$d18O_sw.pre)), col="red", xlim = c(0.075, 0.21))
lined(sqrt(1/(rgamma(100000, 10, 1/5))))
title(xlab=expression(paste(sigma, ", ", delta^{18}, "O time series")), line=xoff)
png("timeseries.png", res=300, units="in", width = 6, height = 2)
layout(matrix(c(1,2,3), ncol=3))
par(mai = c(0.5,0.5,0.1,0.1))
#BWT and d18O timeseries autocorrelation
plotd(sl$BWT.eps.ac, col="red", ylim=c(0,20), xlab="TS autocorrelation")
lined(sl$d18O_sw.eps.ac, col="red", lty=2)
xl = par("usr")[1]+(par("usr")[2]-par("usr")[1])/15
yl = par("usr")[4]-(par("usr")[4]-par("usr")[3])/15
text(xl, yl, "A")
#BWT TS SD
plotd(sqrt(1/sl$BWT.pre), col="red", ylab="")
lined(sqrt(1/rgamma(100000, 20, 2)))
title(xlab=expression(paste(sigma, ", BWT time series")), line=xoff)
xl = par("usr")[1]+(par("usr")[2]-par("usr")[1])/15
yl = par("usr")[4]-(par("usr")[4]-par("usr")[3])/15
text(xl, yl, "B")
#d18O TS SD
plotd(sqrt(1/(sl$d18O_sw.pre)), col="red", ylab="", xlim = c(0.075, 0.21), lty=2)
lined(sqrt(1/(rgamma(100000, 10, 1/5))), lty=2)
title(xlab=expression(paste(sigma, ", ", delta^{18}, "O time series")), line=xoff)
xl = par("usr")[1]+(par("usr")[2]-par("usr")[1])/15
yl = par("usr")[4]-(par("usr")[4]-par("usr")[3])/15
text(xl, yl, "C")
dev.off()
#Set it up
png("timeseries.png", res=300, units="in", width = 6, height = 2)
layout(matrix(c(1,2,3), ncol=3))
par(mai = c(0.5,0.5,0.1,0.1))
#BWT and d18O timeseries autocorrelation
plotd(sl$BWT.eps.ac, col="red", ylim=c(0,20))
lined(sl$d18O_sw.eps.ac, col="red", lty=2)
xl = par("usr")[1]+(par("usr")[2]-par("usr")[1])/15
yl = par("usr")[4]-(par("usr")[4]-par("usr")[3])/15
title(xlab="TS autocorrelation", line=xoff)
text(xl, yl, "A")
#BWT TS SD
plotd(sqrt(1/sl$BWT.pre), col="red", ylab="")
lined(sqrt(1/rgamma(100000, 20, 2)))
title(xlab=expression(paste(sigma, ", BWT time series")), line=xoff)
xl = par("usr")[1]+(par("usr")[2]-par("usr")[1])/15
yl = par("usr")[4]-(par("usr")[4]-par("usr")[3])/15
text(xl, yl, "B")
#d18O TS SD
plotd(sqrt(1/(sl$d18O_sw.pre)), col="red", ylab="", xlim = c(0.075, 0.21), lty=2)
lined(sqrt(1/(rgamma(100000, 10, 1/5))), lty=2)
title(xlab=expression(paste(sigma, ", ", delta^{18}, "O time series")), line=xoff)
xl = par("usr")[1]+(par("usr")[2]-par("usr")[1])/15
yl = par("usr")[4]-(par("usr")[4]-par("usr")[3])/15
text(xl, yl, "C")
dev.off()
plotd(sqrt(1/sl$BWT.pre), col="red", ylab="")
lined(sqrt(1/rgamma(100000, 20, 2)))
title(xlab=expression(paste(sigma ["BWT"])), line=xoff)
xl = par("usr")[1]+(par("usr")[2]-par("usr")[1])/15
yl = par("usr")[4]-(par("usr")[4]-par("usr")[3])/15
text(xl, yl, "B")
plotd(sqrt(1/(sl$d18O_sw.pre)), col="red", ylab="", xlim = c(0.075, 0.21), lty=2)
lined(sqrt(1/(rgamma(100000, 10, 1/5))), lty=2)
title(xlab=expression(sigma [paste(delta, "18Osw")]), line=xoff)
xl = par("usr")[1]+(par("usr")[2]-par("usr")[1])/15
yl = par("usr")[4]-(par("usr")[4]-par("usr")[3])/15
text(xl, yl, "C")
png("timeseries.png", res=300, units="in", width = 6, height = 2)
layout(matrix(c(1,2,3), ncol=3))
par(mai = c(0.5,0.5,0.1,0.1))
#BWT and d18O timeseries autocorrelation
plotd(sl$BWT.eps.ac, col="red", ylim=c(0,20))
lined(sl$d18O_sw.eps.ac, col="red", lty=2)
xl = par("usr")[1]+(par("usr")[2]-par("usr")[1])/15
yl = par("usr")[4]-(par("usr")[4]-par("usr")[3])/15
title(xlab=expression(phi), line=xoff)
text(xl, yl, "A")
#BWT TS SD
plotd(sqrt(1/sl$BWT.pre), col="red", ylab="")
lined(sqrt(1/rgamma(100000, 20, 2)))
title(xlab=expression(paste(sigma ["BWT"])), line=xoff)
xl = par("usr")[1]+(par("usr")[2]-par("usr")[1])/15
yl = par("usr")[4]-(par("usr")[4]-par("usr")[3])/15
text(xl, yl, "B")
#d18O TS SD
plotd(sqrt(1/(sl$d18O_sw.pre)), col="red", ylab="", xlim = c(0.075, 0.21), lty=2)
lined(sqrt(1/(rgamma(100000, 10, 1/5))), lty=2)
title(xlab=expression(sigma [paste(delta, "18Osw")]), line=xoff)
xl = par("usr")[1]+(par("usr")[2]-par("usr")[1])/15
yl = par("usr")[4]-(par("usr")[4]-par("usr")[3])/15
text(xl, yl, "C")
dev.off()
1/0.4
png("timeseries.png", res=300, units="in", width = 6, height = 2)
layout(matrix(c(1,2,3), ncol=3))
par(mai = c(0.5,0.5,0.1,0.1))
#BWT and d18O timeseries autocorrelation
plotd(sl$BWT.eps.ac, col="red", ylim=c(0,20))
lined(sl$d18O_sw.eps.ac, col="red", lty=2)
line(c(0,0.4), c(2.5,2.5))
xl = par("usr")[1]+(par("usr")[2]-par("usr")[1])/15
yl = par("usr")[4]-(par("usr")[4]-par("usr")[3])/15
title(xlab=expression(phi), line=xoff)
text(xl, yl, "A")
#BWT TS SD
plotd(sqrt(1/sl$BWT.pre), col="red", ylab="")
lined(sqrt(1/rgamma(100000, 20, 2)))
title(xlab=expression(paste(sigma ["BWT"])), line=xoff)
xl = par("usr")[1]+(par("usr")[2]-par("usr")[1])/15
yl = par("usr")[4]-(par("usr")[4]-par("usr")[3])/15
text(xl, yl, "B")
#d18O TS SD
plotd(sqrt(1/(sl$d18O_sw.pre)), col="red", ylab="", xlim = c(0.075, 0.21), lty=2)
lined(sqrt(1/(rgamma(100000, 10, 1/5))), lty=2)
title(xlab=expression(sigma [paste(delta, "18Osw")]), line=xoff)
xl = par("usr")[1]+(par("usr")[2]-par("usr")[1])/15
yl = par("usr")[4]-(par("usr")[4]-par("usr")[3])/15
text(xl, yl, "C")
dev.off()
png("timeseries.png", res=300, units="in", width = 6, height = 2)
layout(matrix(c(1,2,3), ncol=3))
par(mai = c(0.5,0.5,0.1,0.1))
#BWT and d18O timeseries autocorrelation
plotd(sl$BWT.eps.ac, col="red", ylim=c(0,20))
lined(sl$d18O_sw.eps.ac, col="red", lty=2)
lines(c(0,0.4), c(2.5,2.5))
xl = par("usr")[1]+(par("usr")[2]-par("usr")[1])/15
yl = par("usr")[4]-(par("usr")[4]-par("usr")[3])/15
title(xlab=expression(phi), line=xoff)
text(xl, yl, "A")
#BWT TS SD
plotd(sqrt(1/sl$BWT.pre), col="red", ylab="")
lined(sqrt(1/rgamma(100000, 20, 2)))
title(xlab=expression(paste(sigma ["BWT"])), line=xoff)
xl = par("usr")[1]+(par("usr")[2]-par("usr")[1])/15
yl = par("usr")[4]-(par("usr")[4]-par("usr")[3])/15
text(xl, yl, "B")
#d18O TS SD
plotd(sqrt(1/(sl$d18O_sw.pre)), col="red", ylab="", xlim = c(0.075, 0.21), lty=2)
lined(sqrt(1/(rgamma(100000, 10, 1/5))), lty=2)
title(xlab=expression(sigma [paste(delta, "18Osw")]), line=xoff)
xl = par("usr")[1]+(par("usr")[2]-par("usr")[1])/15
yl = par("usr")[4]-(par("usr")[4]-par("usr")[3])/15
text(xl, yl, "C")
dev.off()
png("timeseries.png", res=300, units="in", width = 6, height = 2)
layout(matrix(c(1,2,3), ncol=3))
par(mai = c(0.5,0.5,0.1,0.1))
#BWT and d18O timeseries autocorrelation
plotd(sl$BWT.eps.ac, col="red", ylim=c(0,20))
lined(sl$d18O_sw.eps.ac, col="red", lty=2)
lines(c(0,0.4), c(2.5,2.5))
xl = par("usr")[2]-(par("usr")[2]-par("usr")[1])/15
yl = par("usr")[4]-(par("usr")[4]-par("usr")[3])/15
title(xlab=expression(phi), line=xoff)
text(xl, yl, "A")
#BWT TS SD
plotd(sqrt(1/sl$BWT.pre), col="red", ylab="")
lined(sqrt(1/rgamma(100000, 20, 2)))
title(xlab=expression(paste(sigma ["BWT"])), line=xoff)
xl = par("usr")[2]-(par("usr")[2]-par("usr")[1])/15
yl = par("usr")[4]-(par("usr")[4]-par("usr")[3])/15
text(xl, yl, "B")
#d18O TS SD
plotd(sqrt(1/(sl$d18O_sw.pre)), col="red", ylab="", xlim = c(0.075, 0.21), lty=2)
lined(sqrt(1/(rgamma(100000, 10, 1/5))), lty=2)
title(xlab=expression(sigma [paste(delta, "18Osw")]), line=xoff)
xl = par("usr")[2]-(par("usr")[2]-par("usr")[1])/15
yl = par("usr")[4]-(par("usr")[4]-par("usr")[3])/15
text(xl, yl, "C")
dev.off()
smoothScatter(sl$MgCa_sw_m.pre, sl$MgCa_sw_m.eps.ac)
smoothScatter(sl$d18O_sw.pre, sl$d18O_sw.eps.ac)
smoothScatter(sl$BWT_m.pre, sl$BWT_m.eps.ac)
smoothScatter(sl$BWT.pre, sl$BWT.eps.ac)
lc.cov = cov(sl$lc)
a.cov = cov(sl$a)
lc.cov
lc.cor = cor(sl$lc)
a.cor = cor(sl$a)
lc.cor
a.cor
paste0("expression(paste(", pre" , delta^{2}, \"H (\u2030, VSMOW)\"", post, "))")
paste0("expression(paste(", pre, ", delta^{2}, \"H (\u2030, VSMOW)\"", post, "))")
paste0("expression(paste(\"", pre, "\", delta^{2}, \"H (\u2030, VSMOW)\"", post, "))")
##Expression for isotope deltas
delta = function(i, pre="", post=""){
v = switch(i,
h=paste0("expression(paste(\"", pre, "\", delta^{2}, \"H (\u2030, VSMOW)\"", post, "))"),
o_s=expression(paste(pre, delta^{18}, "O (\u2030, VSMOW)", post)),
o_v=expression(paste(pre, delta^{18}, "O (\u2030, VPDB)", post)),
c=expression(paste(pre, delta^{13}, "C (\u2030, VPDB)", post)),
n=expression(paste(pre, delta^{15}, "N (\u2030, AIR)", post)))
return(v)
}
plot(c(0,1), c(1,2), xlab=delta(h))
plot(c(0,1), c(1,2), xlab=delta("h"))
##Expression for isotope deltas
delta = function(i, pre="", post=""){
v = switch(i,
h=paste0("paste(\"", pre, "\", delta^{2}, \"H (\u2030, VSMOW)\"", post, ")"),
o_s=expression(paste(pre, delta^{18}, "O (\u2030, VSMOW)", post)),
o_v=expression(paste(pre, delta^{18}, "O (\u2030, VPDB)", post)),
c=expression(paste(pre, delta^{13}, "C (\u2030, VPDB)", post)),
n=expression(paste(pre, delta^{15}, "N (\u2030, AIR)", post)))
return(v)
}
plot(c(0,1), c(1,2), xlab=expression(delta("h")))
